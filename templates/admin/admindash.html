{% extends "base.html" %}

{% block title %}Admin Dashboard ‚Äî SmartPrint Pro{% endblock %}

{% block content %}
<section class="dashboard-shell">
  <div class="dashboard-grid">
    <aside class="dashboard-sidebar">
      <h2>Welcome, {{ user.full_name }} üëã</h2>
      <p>You are logged in as <strong>{{ user.user_type|capitalize }}</strong>.</p>

      <a href="{{ url_for('admin_users') }}" class="btn-primary" style="margin-top:20px;display:inline-block;">
        üë• User management
      </a>
      <a href="{{ url_for('admin_password_requests') }}" class="btn-secondary" style="margin-top:12px;display:inline-block;">
        üîê Password resets
        {% if pending_reset_count %}
          <span class="badge">{{ pending_reset_count }}</span>
        {% endif %}
      </a>
    </aside>

    <div class="dashboard-main">
      <div class="stats-row">
        <div class="stat-card">
          <h3>Customers</h3>
          <p class="stat-number">{{ user_counts.customers if user_counts is defined else 0 }}</p>
        </div>
        <div class="stat-card">
          <h3>Staff</h3>
          <p class="stat-number">{{ user_counts.staff if user_counts is defined else 0 }}</p>
        </div>
        <div class="stat-card">
          <h3>Admins</h3>
          <p class="stat-number">{{ user_counts.admins if user_counts is defined else 0 }}</p>
        </div>
      </div>

      <div class="stats-table">
        <h3>User breakdown</h3>
        <table>
          <thead>
            <tr>
              <th>Role</th>
              <th>Count</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Customers</td>
              <td>{{ user_counts.customers if user_counts is defined else 0 }}</td>
            </tr>
            <tr>
              <td>Staff</td>
              <td>{{ user_counts.staff if user_counts is defined else 0 }}</td>
            </tr>
            <tr>
              <td>Admins</td>
              <td>{{ user_counts.admins if user_counts is defined else 0 }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<style>
  .dashboard-shell{max-width:1100px;margin:60px auto;padding:0 20px}
  .dashboard-grid{display:grid;grid-template-columns:260px 1fr;gap:20px}
  .dashboard-sidebar{background:#fff;padding:24px;border-radius:16px;box-shadow:0 18px 50px rgba(0,0,0,0.06)}
  .dashboard-main{display:flex;flex-direction:column;gap:20px}
  .stats-row{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px}
  .stat-card{background:#fff;padding:20px;border-radius:16px;box-shadow:0 18px 50px rgba(0,0,0,0.06)}
  .stat-number{font-size:28px;font-weight:800;margin:8px 0 0;color:var(--purple)}
  .stats-table{background:#fff;padding:20px;border-radius:16px;box-shadow:0 18px 50px rgba(0,0,0,0.06)}
  .stats-table table{width:100%;border-collapse:collapse;font-size:14px}
  .stats-table th,.stats-table td{padding:8px 6px;border-bottom:1px solid #eee;text-align:left}
  .btn-primary{background:var(--purple);color:#fff;padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:600}
  .btn-primary:hover{background:#571590}
  .btn-secondary{background:#f4f4f4;color:#333;padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:600}
  .btn-secondary:hover{background:#e9e9e9}
  .badge{display:inline-flex;align-items:center;justify-content:center;background:#f87171;color:#fff;border-radius:999px;font-size:12px;padding:2px 8px;margin-left:6px}
  @media(max-width:900px){
    .dashboard-grid{grid-template-columns:1fr}
    .stats-row{grid-template-columns:repeat(auto-fit,minmax(140px,1fr))}
  }
</style>
{% endblock %}
