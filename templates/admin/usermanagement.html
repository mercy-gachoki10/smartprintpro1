{% extends "base.html" %}

{% block title %}User Management — SmartPrint Pro{% endblock %}

{% block content %}
<section class="dashboard-shell">
  <div class="dashboard-card">
    <div class="header-row">
      <div>
        <h2>User management</h2>
        <p style="margin:4px 0 0;color:var(--muted);font-size:14px;">
          Manage customers, staff, and admins. Edit details or deactivate accounts.
        </p>
      </div>
      <div class="summary">
        <div class="pill">Customers: {{ user_counts.customers }}</div>
        <div class="pill">Staff: {{ user_counts.staff }}</div>
        <div class="pill">Admins: {{ user_counts.admins }}</div>
        <a href="{{ url_for('admin_password_requests') }}" class="link-btn" style="margin-left:auto;">Manage password resets →</a>
      </div>
    </div>

    <div class="tables-grid">
      <div class="table-card">
        <h3>Customers</h3>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Status</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for u in customers %}
              <tr>
                <td>{{ u.full_name }}</td>
                <td>{{ u.email }}</td>
                <td>{{ u.phone }}</td>
                <td>
                  {% if u.active %}
                    <span class="status-badge status-active">Active</span>
                  {% else %}
                    <span class="status-badge status-inactive">Inactive</span>
                  {% endif %}
                </td>
                <td>
                  <a href="{{ url_for('admin_edit_user', user_type='customer', user_id=u.id) }}" class="link-btn">Edit</a>
                </td>
              </tr>
            {% else %}
              <tr><td colspan="5" class="empty-cell">No customers yet.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="table-card">
        <h3>Staff</h3>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Status</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for u in staff_members %}
              <tr>
                <td>{{ u.full_name }}</td>
                <td>{{ u.email }}</td>
                <td>{{ u.phone }}</td>
                <td>
                  {% if u.active %}
                    <span class="status-badge status-active">Active</span>
                  {% else %}
                    <span class="status-badge status-inactive">Inactive</span>
                  {% endif %}
                </td>
                <td>
                  <a href="{{ url_for('admin_edit_user', user_type='staff', user_id=u.id) }}" class="link-btn">Edit</a>
                </td>
              </tr>
            {% else %}
              <tr><td colspan="5" class="empty-cell">No staff members yet.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="table-card">
        <h3>Admins</h3>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for u in admins %}
              <tr>
                <td>{{ u.full_name }}</td>
                <td>{{ u.email }}</td>
                <td>{{ u.phone }}</td>
                <td>
                  {% if u.active %}
                    <span class="status-badge status-active">Active</span>
                  {% else %}
                    <span class="status-badge status-inactive">Inactive</span>
                  {% endif %}
                </td>
              </tr>
            {% else %}
              <tr><td colspan="4" class="empty-cell">No admins found.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<style>
  .dashboard-shell{max-width:1100px;margin:60px auto;padding:0 20px}
  .dashboard-card{background:#fff;padding:24px 24px 28px;border-radius:16px;box-shadow:0 18px 50px rgba(0,0,0,0.06)}
  .header-row{display:flex;justify-content:space-between;align-items:flex-start;gap:16px;margin-bottom:18px}
  .summary{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
  .pill{background:#f3e8ff;color:#4b0082;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:600}
  .tables-grid{display:flex;flex-direction:column;gap:18px;margin-top:10px}
  .table-card h3{margin:0 0 8px}
  .table-card table{width:100%;border-collapse:collapse;font-size:14px}
  .table-card th,.table-card td{padding:8px 6px;border-bottom:1px solid #eee;text-align:left}
  .status-badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:11px;font-weight:600}
  .status-active{background:#dcfce7;color:#166534}
  .status-inactive{background:#fee2e2;color:#b91c1c}
  .link-btn{color:var(--purple);text-decoration:none;font-weight:600;font-size:13px}
  .link-btn:hover{text-decoration:underline}
  .empty-cell{text-align:center;color:var(--muted);font-style:italic}
  @media(max-width:800px){
    .header-row{flex-direction:column;align-items:flex-start}
  }
</style>
{% endblock %}
